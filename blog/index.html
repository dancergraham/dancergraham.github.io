<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<link rel="stylesheet" href="../static/style.css">
<link rel="stylesheet" href="../static/pygments.css">
<link rel="icon" type="image/x-icon" href="../static/favicon.ico">
<meta name="viewport" content="width=device-width">
<meta name="og:title" content="Graham Knapp's Blog">
<meta name="og:url" content="https://grahamknapp.com">
<meta name="og:type" content="website">
<meta name="og:description"
      content="Graham Knapp's homepage and blog.  Graham is a British Engineer and musician living in France">
<meta name="description"
      content="Graham Knapp's homepage and blog.  Graham is a British Engineer and musician living in France">
<meta property="og:image" content="https://grahamknapp.com/graham.png" />

<title>Graham Knapp — blog</title>
</head>
<body>
<header>
    <h1><a href="../">Graham Knapp</a></h1>

    <nav>
        <ul class="nav navbar-nav">
            <li><a href="../">Welcome</a></li>
            
                <li class="active"><a href="./">Blog</a>
                </li>
            
                <li><a href="../contact/">Contact</a>
                </li>
            
                <li><a href="../about/">About</a>
                </li>
            
            <li><a href="/feed.xml"><img src="../static/rss-feed.png" title="RSS Feed" alt="RSS Feed"
                                                 style="width: 24px; height: 24px;"></a></li>
        </ul>
    </nav>
    <div>

    </div>
</header>
<div class="page">
    
    
  
    <a href="tags/design-patterns/" class="tag" title="design patterns articles">design patterns</a>
  
    <a href="tags/e57/" class="tag" title="e57 articles">e57</a>
  
    <a href="tags/feature-flags/" class="tag" title="feature flags articles">feature flags</a>
  
    <a href="tags/pointcloud/" class="tag" title="pointcloud articles">pointcloud</a>
  
    <a href="tags/python/" class="tag" title="python articles">python</a>
  
    <a href="tags/rhino-3d/" class="tag" title="Rhino 3D articles">Rhino 3D</a>
  
    <a href="tags/wind-engineering/" class="tag" title="wind engineering articles">wind engineering</a>
  

    
        <div>
            
            
  <div class="blog-post">
  
    <h2><a href="e57-file-xml-tool/">E57 file xml extractor 🔗</a></h2>
  
  <p class="meta">
    written by
    
      <a href="https://hachyderm.io/@graham_knapp">Graham Knapp</a>
    
    on 2025-01-26
  </p>
  
      <p>See the xml portion from the end of an <code>.e57</code> pointcloud file. This contains information like the bounding box of the
pointcloud, the number of points and how the points and other information are organised in the file.</p>
<p>I wrote it with a bit of help from Claude ai by describing what I wanted and pasting a description of the e57 file
format before doing a lot of debugging to get the entire xml section and then integrating it with my blog.</p>
<p>I find the e57 file format a bit <em>wierd</em> - it starts with a header including a file version number and an offset to the XML portion, 
which comes at the <em>end</em> of the file so you need to read both ends of the file before you can understand the middle bit. So 
if you download the file you have to wait for it to finish downloading - you can't start to interpret or display the 
points and other data whilst streaming data.</p>
<p>This tool is written in JavaScript and runs in your browser - no files are uploaded to any server (in fact this blog has no backend server - it
is a static web site - it is downloaded and runs entirely in your browser).</p>
<p><div id="file-upload">
    <label>
        Select E57 File
        <input type="file" id="e57-input" accept=".e57" style="display:none;">
    </label>
</div></p>
<p><div id="error" style="display:none;"></div></p>
<pre id="xml-content" class="highlight">
</pre><script>
    document.getElementById('file-upload').addEventListener('click', () => {
        document.getElementById('e57-input').click();
    });

document.getElementById('e57-input').addEventListener('change', async (event) => {
        if (!event.target.files.length) {
            return;
        }
        const file = event.target.files[0];
        const errorDiv = document.getElementById('error');
        const xmlContentDiv = document.getElementById('xml-content');

        errorDiv.textContent = '';
        xmlContentDiv.textContent = '';

        try {
            const arrayBuffer = await file.arrayBuffer();
            const buffer = new Uint8Array(arrayBuffer);
            errorDiv.style.display = 'none';

            // Parse file header
            const fileHeader = {
                fileSignature: new TextDecoder().decode(buffer.slice(0, 8)),
                majorVersion: new DataView(buffer.buffer).getUint32(8, true),
                minorVersion: new DataView(buffer.buffer).getUint32(12, true),
                xmlPhysicalOffset: new DataView(buffer.buffer).getBigUint64(24, true)
            };

            // Validate file signature
            if (fileHeader.fileSignature !== 'ASTM-E57') {
                throw new Error('Not a valid E57 file');
            }

            // Extract XML section
            let xmlBytes = [];
            let offset = Number(fileHeader.xmlPhysicalOffset);

            while (offset < buffer.length) {
                const pageStart = Math.floor(offset / 1024) * 1024;
                const pageEnd = Math.min(pageStart + 1020, buffer.length);  // Exclude 4-byte checksum
                const pageData = buffer.slice(pageStart, pageEnd);
                xmlBytes.push(...pageData.slice(offset % 1024));
                offset += (1024 - (offset % 1024));
            }
            // Convert XML bytes to string
            let xmlString = new TextDecoder().decode(new Uint8Array(xmlBytes));

            // Find the start of the XML declaration
            const xmlStart = xmlString.indexOf('<?xml');
            if (xmlStart === -1) {
                throw new Error('No valid XML found');
            }

            // end at the first instance of </e57Root>
            const xmlEnd = xmlString.indexOf('</e57Root>');
            if (xmlEnd === -1) {
                throw new Error('No valid XML found');
            }

            xmlString = xmlString.slice(xmlStart, xmlEnd + 10);
            xmlContentDiv.textContent = xmlString;

        } catch (err) {
            errorDiv.textContent = err.message;
            errorDiv.style.display = 'block';
        } finally {
            event.target.value = '';
        }
    });

</script>
    </div>

        </div>
        <hr>
    
        <div>
            
            
  <div class="blog-post">
  
    <h2><a href="twos-company-threes-a-crowd/">Two&#39;s company, three&#39;s a crowd 🔗</a></h2>
  
  <p class="meta">
    written by
    
      <a href="https://hachyderm.io/@graham_knapp">Graham Knapp</a>
    
    on 2025-01-20
  </p>
  
      <p>My version of YAGNI - "You Ain't Gonna Need It" - is a rule of three: only spend time refactoring your code when you have repeated yourself 3 times. Don't aim for truly DRY code devoid of all repetition.</p>
<p>I'm not saying not to apply SOLID design principles from the start - I definitely try to separate concerns, giving a single responsibility to a class or function and avoid, for instance, a single method handling file reading, data transformation and reporting.  This simplicity will make it much easier to refactor the code later.</p>
<p>I am saying to avoid using sophisticated design patterns, architecture or abstractions before you have used of your code enough to know what is likely to change (and require encapsulation) and what will stay constant (creating a useful abstraction). 
<br><br><a href="twos-company-threes-a-crowd/">Read Full Post</a></p>

    </div>

        </div>
        <hr>
    
        <div>
            
            
  <div class="blog-post">
  
    <h2><a href="the-zen-of-python-revisited/">The Zen of Python: Gur Mra bs Clguba. 🔗</a></h2>
  
  <p class="meta">
    written by
    
      <a href="https://hachyderm.io/@graham_knapp">Graham Knapp</a>
    
    on 2025-01-14
  </p>
  
      <p>I love The Zen of Python - one of the delights of the language is typing <code>import this</code> in a REPL and discovering this gem:</p>
<div class="hll"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">this</span>
</pre></div>
<div class="hll"><pre><span></span><span class="go">The Zen of Python, by Tim Peters</span>

<span class="go">Beautiful is better than ugly.</span>
<span class="go">Explicit is better than implicit.</span>
<span class="go">Simple is better than complex.</span>
<span class="go">Complex is better than complicated.</span>
<span class="go">Flat is better than nested.</span>
<span class="go">Sparse is better than dense.</span>
<span class="go">Readability counts.</span>
<span class="go">Special cases aren&#39;t special enough to break the rules.</span>
<span class="go">Although practicality beats purity.</span>
<span class="go">Errors should never pass silently.</span>
<span class="go">Unless explicitly silenced.</span>
<span class="go">In the face of ambiguity, refuse the temptation to guess.</span>
<span class="go">There should be one-- and preferably only one --obvious way to do it.</span>
<span class="go">Although that way may not be obvious at first unless you&#39;re Dutch.</span>
<span class="go">Now is better than never.</span>
<span class="go">Although never is often better than *right* now.</span>
<span class="go">If the implementation is hard to explain, it&#39;s a bad idea.</span>
<span class="go">If the implementation is easy to explain, it may be a good idea.</span>
<span class="go">Namespaces are one honking great idea -- let&#39;s do more of those!</span>
</pre></div>
<p>It neatly captures the way in which Guido van Rossum and a group of Pythonistas thought about 
the language, constructed and used it, sharing thoughts on user forums in in-person meetings.
<br><br><a href="the-zen-of-python-revisited/">Read Full Post</a></p>

    </div>

        </div>
        <hr>
    
        <div>
            
            
  <div class="blog-post">
  
    <h2><a href="feature-flags-pt-2-start-small/">Feature flags Pt 2: Start small 🔗</a></h2>
  
  <p class="meta">
    written by
    
      <a href="https://hachyderm.io/@graham_knapp">Graham Knapp</a>
    
    on 2025-01-05
  </p>
  
      <p>In our team we started with the smallest possible shareable system - a flags namespace in our front-end code. We later adopted an existing open source library in the back end.  This got me thinking - what is the smallest possible feature flag system?</p>
<p><img src="feature-flags-pt-2-start-small/640px-Britains_Deetail_Waterloo_British_Officer_with_Sword_and_Flag.jpg" alt="Britains Deetail Waterloo British Officer with Sword and Flag by Sclight"></p>
<p>Here's a Hello World example...</p>
<h3>The world without flags</h3>
<div class="hll"><pre><span></span><span class="c1"># greet.py</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello, world!&quot;</span><span class="p">)</span>
</pre></div>
<p><br><br><a href="feature-flags-pt-2-start-small/">Read Full Post</a></p>

    </div>

        </div>
        <hr>
    
        <div>
            
            
  <div class="blog-post">
  
    <h2><a href="feature-flags-pt-1-whats-so-great-about-feature-flags/">Feature flags Pt 1: Faster feature development with flags. 🔗</a></h2>
  
  <p class="meta">
    written by
    
      <a href="https://hachyderm.io/@graham_knapp">Graham Knapp</a>
    
    on 2025-01-02
  </p>
  
      <p>The greatest accelerator of my team's work last year was adopting feature flags. With flags we ship features faster, more confidently and with less stress. We have fewer merge conflicts despite frequently working together on the same part of the code base.</p>
<p><img src="feature-flags-pt-1-whats-so-great-about-feature-flags/Sbandieratori_3.JPG" alt="Men in colourful mediaeval costumes throwing huge flags into the air in a central Italian flagged square, thousands of onlookers in the background">
<br><br><a href="feature-flags-pt-1-whats-so-great-about-feature-flags/">Read Full Post</a></p>

    </div>

        </div>
        <hr>
    
        <div>
            
            
  <div class="blog-post">
  
    <h2><a href="result-pattern-an-exceptional-way-to-handle-errors/">Result pattern - An exceptional way to handle errors 🔗</a></h2>
  
  <p class="meta">
    written by
    
      <a href="https://hachyderm.io/@graham_knapp">Graham Knapp</a>
    
    on 2024-12-30
  </p>
  
      <p>People often say that in Python you should use exceptions - "Easier to Ask Forgiveness than Permission" (EAFP) over guard clauses - "Look Before You Leap" (LBYL), but the Result design pattern - returning an object which explicitly states whether the operation succeeded is a useful alternative where error handling is required and, as I learned by exploring in more depth, it can be compatible with both approaches.</p>
<p>As my <a href="https://github.com/dancergraham/HeadFirstDesignPatterns_python">design patterns repo</a> approaches <code>100⭐</code> on GitHub I decided to add the <a href="https://github.com/dancergraham/HeadFirstDesignPatterns_python/tree/main/extra_result">Result design pattern</a> to the mix</p>
<h2>EAFP vs LBYL</h2>
<p>or <em>Graham plays with GitHub Code Search</em></p>
<p>Prompted by <a href="https://fosstodon.org/@CodenameTim/113730836308245068">a post on Mastodon</a>
I looked a bit more into which patterns people are using for error handling
specifically for attribute lookup: I'm surprised to see twice as many
references to <a href="https://github.com/search?type=code&amp;auto_enroll=true&amp;q=hasattr+language%3APython">hasattr</a>
as for <a href="https://github.com/search?type=code&amp;auto_enroll=true&amp;q=except+AttributeError+language%3APython+">"except AttributeError"</a></p>
<p>and not only for dynamic lookups but also for general attribute search, so a win for LBYL vs EAFP style with Python, despite the latter often being recommended ?</p>

    </div>

        </div>
        <hr>
    
        <div>
            
            
  <div class="blog-post">
  
    <h2><a href="city-modelling-with-gen-ai/">City Modelling with Generative AI: Tool or toy? 🔗</a></h2>
  
  <p class="meta">
    written by
    
      <a href="https://hachyderm.io/@graham_knapp">Graham Knapp</a>
    
    on 2023-01-02
  </p>
  
      <p>AI tools such as Chat-Gpt (text generation) and Dall-E (image generation) are making impressive leaps, allowing people to rapidly generate text, code and images from simple input prompts. The next frontier in generative AI may be 3D modelling, and OpenAI recently released the open source 3D modelling software Point·E. Could computer games, films and even architecture use these techniques to replace or improve manual city modelling?</p>
<p><img src="city-modelling-with-gen-ai/33_3D_models.jpg" alt="33 3D mesh models, each generated from the text prompt &quot;a buildng&quot;​
"></p>
<p><em>33 3D mesh models, each generated from the text prompt "a buildng"​</em><br><br><a href="city-modelling-with-gen-ai/">Read Full Post</a></p>

    </div>

        </div>
        <hr>
    
        <div>
            
            
  <div class="blog-post">
  
    <h2><a href="trouver-un-musicotherapeute/">🎼Trouver un musicothérapeute🎼 🔗</a></h2>
  
  <p class="meta">
    written by
    
      <a href="knapp_graham">Graham Knapp</a>
    
    on 2021-07-20
  </p>
  
      <p>Ma femme est non seulement une superbe musicienne mais aussi une musicothérapeute : elle soigne les gens, ou les aide à se soigner eux-mêmes, avec de la musique!</p>
<p>J'ai crée cette <a href="https://dancergraham.github.io/blog/trouver-un-musicotherapeute/musicotherapeutes.html">carte des musicothérapeutes français</a> avec la méthode suivante:</p>
<ul>
<li>Scrape le <a href="https://www.musicotherapie-federationfrancaise.com/trouver-un-musicotherapeute/">site web de la Fédération Française de Musicothérapie</a> avec Requests et Beautiful Soup</li>
<li>Géocoder les addresses de tous les musicothérapeutes via OSM (cette partie prend plusieurs minutes)</li>
<li>Créer une carte avec un marqueur par musicothérapeute avec Folium.</li>
<li>Enregistrer la carte sous format html</li>
</ul>
<p>J'utilise la fonction suivantes pour générer mes tags HTML pour les marqueurs:</p>
<div class="hll"><pre><span></span><span class="k">def</span> <span class="nf">tagged</span><span class="p">(</span><span class="n">txt</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
    <span class="nb">str</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;</span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">txt</span><span class="si">}</span><span class="s2">&lt;/</span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</pre></div>
<p>Voici <a href="https://github.com/dancergraham/carte_musicotherapeutes">le script complet sous forme de Jupyter Notebook</a>.</p>

    </div>

        </div>
        <hr>
    
        <div>
            
            
  <div class="blog-post">
  
    <h2><a href="game-of-life-in-rhino-3d/">Game of life in Rhino 3D 🔗</a></h2>
  
  <p class="meta">
    written by
    
      <a href="https://hachyderm.io/@graham_knapp">Graham Knapp</a>
    
    on 2020-12-18
  </p>
  
      <p>Hello.</p>
<p>Prompted by this year’s Advent Of Code challenge I have implemented a 3D version of the game of life in Python in Rhino 7.</p>
<p>Here are some images renders from individual steps in my solution, followed by the code I used to generate them.</p>
<p><img src="game-of-life-in-rhino-3d/step-5.jpeg" alt="A rendered 3D image of dozens of white spheres, densely packed, against a white background"><br><br><a href="game-of-life-in-rhino-3d/">Read Full Post</a></p>

    </div>

        </div>
        <hr>
    
        <div>
            
            
  <div class="blog-post">
  
    <h2><a href="rhinopython-may-the-source-be-with-you/">RhinoPython: may the source be with you! 🔗</a></h2>
  
  <p class="meta">
    written by
    
      <a href="https://hachyderm.io/@graham_knapp">Graham Knapp</a>
    
    on 2019-05-12
  </p>
  
      <p>Hello everyone,</p>
<p>I wrote a script to help me code in python and learn RhinoCommon and decided to share it with you 😜</p>
<p>As you may know, the rhinoscriptsyntax library is written in Python and uses rhinocommon functions, also in Python, under the hood. In order to look up the underlying code you can open up the full python file, you can use the inspect module or you can save the script below to your computer and run it each time you want to look up a particular function. For instance if you search for ‘bounding’ you get the following options:</p>
<p><img src="rhinopython-may-the-source-be-with-you/rhinopython_source_0.png" alt="Search and select dialog box for library function"><br><br><a href="rhinopython-may-the-source-be-with-you/">Read Full Post</a></p>

    </div>

        </div>
        <hr>
    

    
  <div class="pagination">
    
      <span class="disabled">&laquo; Previous</span>
    
    | 1 |
    
      <a href="page/2/">Next &raquo;</a>
    
  </div>


</div>
<footer>
    &copy; Copyright 2019 - 2025 by Graham Knapp.
</footer>
</body>
</html>
